# =============================================================================
# データサイエンスプログラミング入門 期末レポート課題
# R版テンプレート
# =============================================================================
# 学籍番号: 2560XX  （XXを自分の番号に変更）
# 氏名:             （自分の氏名を記入）
# =============================================================================
#
# 【プログラム概要・工夫した点】（400字以内で記述してください）
# ここにプログラムの概要と工夫した点を記述してください。
# 例：
# - 本プログラムは、乱数を用いて50人分の模擬成績データを生成し、
#   記述統計量の算出、性別グループ集計、可視化を行うものである。
# - 工夫した点として、...
#
#
#
#
#
# =============================================================================

# =============================================================================
# 設定
# =============================================================================

# TODO: 自分の学籍番号の下2桁をシードとして設定してください
# 例：学籍番号が 256042 の場合 → MY_SEED <- 42
MY_SEED <- 0  # <- ここを自分の学籍番号下2桁に変更

# 学籍番号下2桁（ファイル名に使用）
STUDENT_NUM <- "XX"  # <- ここを自分の学籍番号下2桁に変更（例："42"）

# データ生成パラメータ
N_STUDENTS <- 50  # 学生数

# 正規乱数のパラメータ（変更不要）
MATH_MEAN <- 60
MATH_SD <- 15
PROG_MEAN <- 70
PROG_SD <- 10

# =============================================================================
# タスク1: 乱数シード設定とデータ生成（25点）
# =============================================================================

cat("============================================================\n")
cat("タスク1: データ生成\n")
cat("============================================================\n")

# TODO: 乱数シードを設定してください
# ヒント: set.seed(MY_SEED)
# <- ここにコードを追加

# 学生ID（1〜50の連番）- これは変更不要
student_id <- 1:N_STUDENTS

# 性別（固定パターン）- これは変更不要
# student_id 1〜25: "M", student_id 26〜50: "F"
gender <- c(rep("M", 25), rep("F", 25))

# TODO: 数学の点数を正規乱数で生成してください
# ヒント: rnorm(N_STUDENTS, mean = MATH_MEAN, sd = MATH_SD)
# 注意: 整数に丸め、0〜100の範囲に収めること
#   - 整数に丸める: round(x) で丸め → as.integer() で整数型に変換
#   - 範囲を制限: pmin(pmax(x, 0), 100) で 0未満は0、100超は100に
#   - 例: as.integer(pmin(pmax(round(乱数), 0), 100))
math <- NULL  # <- ここを修正

# TODO: プログラミングの点数を正規乱数で生成してください
# （数学と同様の手順）
prog <- NULL  # <- ここを修正

cat("シード値:", MY_SEED, "\n")
cat("生成データ数:", N_STUDENTS, "人\n")

# =============================================================================
# タスク2: データフレーム作成（15点）
# =============================================================================

cat("\n============================================================\n")
cat("タスク2: データフレーム作成\n")
cat("============================================================\n")

# TODO: データフレームを作成してください
# ヒント: data.frame(student_id = student_id, gender = gender, ...)
df <- NULL  # <- ここを修正

# TODO: データフレームの先頭5行を表示してください
# ヒント: print(head(df, 5))
cat("\n【データフレームの先頭5行】\n")
# <- ここにコードを追加

# =============================================================================
# タスク3: 記述統計量の算出（25点）
# =============================================================================

cat("\n============================================================\n")
cat("タスク3: 記述統計量\n")
cat("============================================================\n")

# 集計対象の列
score_cols <- c("math", "prog")

# TODO: 2科目の平均を計算・表示してください
# ヒント: sapply(df[score_cols], mean)
cat("\n【各科目の平均】\n")
# <- ここにコードを追加

# TODO: 2科目の標準偏差を計算・表示してください
# ヒント: sapply(df[score_cols], sd)
cat("\n【各科目の標準偏差】\n")
# <- ここにコードを追加

# TODO: 2科目の最小値を計算・表示してください
# ヒント: sapply(df[score_cols], min)
cat("\n【各科目の最小値】\n")
# <- ここにコードを追加

# TODO: 2科目の最大値を計算・表示してください
# ヒント: sapply(df[score_cols], max)
cat("\n【各科目の最大値】\n")
# <- ここにコードを追加

# =============================================================================
# タスク4: グループ集計（15点）
# =============================================================================

cat("\n============================================================\n")
cat("タスク4: 性別グループ集計\n")
cat("============================================================\n")

# TODO: 性別ごとの人数を表示してください
# ヒント: table(df$gender)
cat("\n【性別ごとの人数】\n")
# <- ここにコードを追加

# TODO: 性別ごとの2科目平均を計算・表示してください
# ヒント: aggregate(cbind(math, prog) ~ gender, data = df, mean)
cat("\n【性別ごとの平均点】\n")
# <- ここにコードを追加

# =============================================================================
# タスク5: ヒストグラム作成・保存（15点）
# =============================================================================

cat("\n============================================================\n")
cat("タスク5: ヒストグラム作成\n")
cat("============================================================\n")

# TODO: 数学の点数のヒストグラムを作成・保存してください
# ヒント:
#   png(filename, width = 800, height = 600)
#   hist(df$math, breaks = 10, main = "...", xlab = "...", ylab = "...")
#   dev.off()
# 注意: タイトル、軸ラベルを付けること
# 注意: ファイル名は 2560XX_hist_R.png（XXは学籍番号下2桁）

hist_filename <- paste0("2560", STUDENT_NUM, "_hist_R.png")

# png(hist_filename, width = 800, height = 600)
# <- ここにヒストグラム作成コードを追加
# dev.off()

cat("ヒストグラム保存:", hist_filename, "\n")

# =============================================================================
# 完了メッセージ
# =============================================================================

cat("\n============================================================\n")
cat("処理完了\n")
cat("============================================================\n")
cat("生成ファイル:\n")
cat("  -", hist_filename, "\n")
